<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Supabase - Lifextreme</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        h1 {
            margin-top: 0;
        }

        .status {
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            font-weight: bold;
        }

        .success {
            background: rgba(76, 175, 80, 0.3);
            border-left: 4px solid #4CAF50;
        }

        .error {
            background: rgba(244, 67, 54, 0.3);
            border-left: 4px solid #f44336;
        }

        .loading {
            background: rgba(255, 193, 7, 0.3);
            border-left: 4px solid #FFC107;
        }

        pre {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            overflow-x: auto;
            max-height: 400px;
        }

        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }

        button:hover {
            background: #45a049;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üöÄ Test de Conexi√≥n Supabase</h1>
        <p>Verifica que tu configuraci√≥n de Supabase est√© funcionando correctamente.</p>

        <div id="status" class="status loading">
            ‚è≥ Esperando prueba...
        </div>

        <button onclick="testConnection()">üîå Probar Conexi√≥n</button>
        <button onclick="testTours()">üèîÔ∏è Obtener Tours</button>

        <h2>Resultados:</h2>
        <pre id="results">Haz click en un bot√≥n para probar...</pre>
    </div>

    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm'

        // ‚úÖ Credenciales configuradas para Lifextreme Backend
        const SUPABASE_URL = 'https://zobpkmiqrvhbepqnjshr.supabase.co'
        const SUPABASE_ANON_KEY = 'sb_publishable_pBMaD6Mm-6Pi5cwwp3UUsw_Pndjw-mo'

        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)

        window.testConnection = async function () {
            const statusDiv = document.getElementById('status')
            const resultsDiv = document.getElementById('results')

            statusDiv.className = 'status loading'
            statusDiv.textContent = '‚è≥ Probando conexi√≥n...'

            try {
                // Test simple: obtener versi√≥n de Postgres
                const { data, error } = await supabase
                    .from('tours')
                    .select('count')
                    .limit(1)

                if (error) throw error

                statusDiv.className = 'status success'
                statusDiv.textContent = '‚úÖ ¬°Conexi√≥n exitosa a Supabase!'
                resultsDiv.textContent = JSON.stringify({
                    status: 'success',
                    message: 'Conectado correctamente',
                    timestamp: new Date().toISOString()
                }, null, 2)
            } catch (error) {
                statusDiv.className = 'status error'
                statusDiv.textContent = '‚ùå Error de conexi√≥n'
                resultsDiv.textContent = JSON.stringify({
                    status: 'error',
                    message: error.message,
                    hint: 'Verifica tus credenciales en el c√≥digo'
                }, null, 2)
            }
        }

        window.testTours = async function () {
            const statusDiv = document.getElementById('status')
            const resultsDiv = document.getElementById('results')

            statusDiv.className = 'status loading'
            statusDiv.textContent = '‚è≥ Obteniendo tours...'

            try {
                const { data: tours, error } = await supabase
                    .from('tours')
                    .select('*')
                    .limit(10)

                if (error) throw error

                statusDiv.className = 'status success'
                statusDiv.textContent = `‚úÖ ${tours.length} tours encontrados`
                resultsDiv.textContent = JSON.stringify(tours, null, 2)
            } catch (error) {
                statusDiv.className = 'status error'
                statusDiv.textContent = '‚ùå Error al obtener tours'
                resultsDiv.textContent = JSON.stringify({
                    status: 'error',
                    message: error.message
                }, null, 2)
            }
        }
    </script>
</body>

</html>